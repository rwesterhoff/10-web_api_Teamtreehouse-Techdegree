function showDetails(e){var t=e;$.ajax({url:"https://api.spotify.com/v1/albums/"+t,success:function(e){var t=e.artists[0].name,a=e.name,s=e.images[0].url,n=e.release_date,i=e.tracks.items,r="",l="#js-image-overlay",o="#js-close-overlay",c=function(){r+='<div id="js-image-overlay">',r+='<div id="js-overlay-wrapper">',r+='<button id="js-close-overlay" class="close-overlay">Close overlay</button>',r+='<img src="'+s+'" alt="" class="album-artwork">',r+='<section id="js-data-wrapper">',r+="<h1>"+a+"</h1>",r+='<p><span class="visually-hidden">Artist: </span>'+t+"</p>",r+='<p class="meta">Released on ',r+='<time datetime="'+n+'">'+n+"</time>",r+="</p>",r+='<ul class="play-list">',$.each(i,function(e,t){var a=t.name;r+='<li class="album-track">'+a+"</li>"}),r+='<a id="itunes-button" href="" class="cta-button">',r+='<img src="assets/itunes-badge.svg" alt="Get it oniTunes">',r+="</a>",r+="</ul>",r+="</section>",r+="</div>",r+="</div>",$("body").prepend(r),$(l).hide(),$(l).fadeIn(400),getItunesData(t,a)},u=function(){$(o).click(function(){m()}),$(document).keyup(function(e){27===e.keyCode&&m()}),window.onclick=function(e){var t=e.target.id;"js-image-overlay"===t&&m()}},m=function(){function e(){$(l).remove()}$(l).fadeOut(400),setTimeout(e,400),$(document).off("keydown")};c(),u()}})}function getItunesData(e,t){var a=(e+"+"+t).replace(/ /g,"+").toLowerCase(),s="#itunes-button",n=function(e){$.ajax({url:"https://itunes.apple.com/search/?term="+e,type:"GET",dataType:"jsonp",success:function(e){var t=e.results[0].collectionViewUrl;$("#itunes-button").attr("href",t)},error:function(){alert('error on "getAlbumId"')}})};n(a)}function searchAlbums(){var e=$input.val();$.ajax({url:"https://api.spotify.com/v1/search",data:{q:e,type:"album"},success:function(t){var a=t.albums.items,s="",n=function(){0===a.length?imageGallery.html("<p>We have no search results for <strong>"+e+"</strong></p>"):($.each(a,function(e,t){var a=t.id,n=t.name,i=t.images[1].url;s+='<li class="gallery-item">',s+='<a href="">',s+='<img id="'+a+'" src="'+i+'" alt="'+n+'">',s+="</a>",s+="</li>"}),imageGallery.html(s))},i=function(){$("a").click(function(e){var t=$(this).find("img").attr("id");e.preventDefault(),showDetails(t)})};n(),i()}})}function sortUnorderedList(e,t){if("string"==typeof e&&(e=document.getElementById("image-gallery")),!e)return void alert("The UL object is null!");for(var a=e.getElementsByTagName("LI"),s=[],n=0,i=a.length;n<i;n++)s.push(a[n].innerHTML);s.sort(),t&&s.reverse();for(var n=0,i=a.length;n<i;n++)a[n].innerHTML=s[n]}var $input=$("#query"),imageGallery=$("#image-gallery"),sortByName=$("label[for='name']"),sortByDate=$("label[for='date']");$($input).keyup(function(){searchAlbums()}),sortByName.click(function(){this.attr("checked",checked)}),sortByDate.click(function(){this.attr("checked",checked)});