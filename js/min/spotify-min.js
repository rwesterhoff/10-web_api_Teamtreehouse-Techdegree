function showDetails(e){var a=e;$.ajax({url:"https://api.spotify.com/v1/albums/"+a,success:function(e){var a=e.artists[0].name,t=e.name,s=e.images[0].url,i=e.release_date,n=e.tracks.items,o="",l="#js-image-overlay",r="#js-close-overlay",c=function(){var e=(a+"+"+t).replace(/ /g,"+").toLowerCase(),s=function(e){$.ajax({url:"https://itunes.apple.com/search/?term="+e,type:"GET",dataType:"jsonp",success:function(e){var a=e.results[0].collectionId;console.log(a)},error:function(){alert('error on "getAlbumId"')}})},i=function(e){$.ajax({url:"https://itunes.apple.com/lookup?id="+e,type:"GET",dataType:"jsonp",success:function(e){var a=e.collectionViewUrl;console.log(a)},error:function(){alert('error on "getItunesLink"')}})};iTunesId=s(e)},u=function(){var e=c();o+='<div id="js-image-overlay">',o+='<div id="js-overlay-wrapper">',o+='<button id="js-close-overlay" class="close-overlay">Close overlay</button>',o+='<img src="'+s+'" alt="" class="album-artwork">',o+='<section id="js-data-wrapper">',o+="<h1>"+t+"</h1>",o+='<p><span class="visually-hidden">Artist: </span>'+a+"</p>",o+='<p class="meta">Released on ',o+='<time datetime="'+i+'">'+i+"</time>",o+="</p>",o+='<ul class="play-list">',$.each(n,function(e,a){var t=a.name;o+='<li class="album-track">'+t+"</li>"}),o+='<li id="itunes-store">',o+='<a href="'+e+'" class="cta-button">',o+='<img src="../assets/Get_it_on_iTunes_Badge_US_1114.svg" alt="Get it oniTunes">',o+="</a>",o+="</li>",o+="</ul>",o+="</section>",o+="</div>",o+="</div>",$("body").prepend(o),$(l).hide(),$(l).fadeIn(400)},m=function(){$(r).click(function(){p()}),$(document).keyup(function(e){27===e.keyCode&&p()}),window.onclick=function(e){var a=e.target.id;"js-image-overlay"===a&&p()}},p=function(){function e(){$(l).remove()}$(l).fadeOut(400),setTimeout(e,400),$(document).off("keydown")};u(),m()}})}function searchAlbums(){var e=$input.val();$.ajax({url:"https://api.spotify.com/v1/search",data:{q:e,type:"album"},success:function(a){var t=a.albums.items,s="",i=function(){0===t.length?imageGallery.html("<p>We have no search results for <strong>"+e+"</strong></p>"):($.each(t,function(e,a){var t=a.id,i=a.name,n=a.images[1].url;s+='<li class="gallery-item">',s+='<a href="">',s+='<img id="'+t+'" src="'+n+'" alt="'+i+'">',s+="</a>",s+="</li>"}),imageGallery.html(s))},n=function(){$("a").click(function(e){var a=$(this).find("img").attr("id");e.preventDefault(),showDetails(a)})};i(),n()}})}var $input=$("#query"),imageGallery=$("#image-gallery");$($input).keyup(function(){searchAlbums()});